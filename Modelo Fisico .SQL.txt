CREATE TABLE PESSOA(
	ID_PESSOA SERIAL,
	NOME VARCHAR NOT NULL,
	DATA_NASCIMENTO DATE NOT NULL,
	SEXO VARCHAR NOT NULL,
	CNPJ VARCHAR,
	NOME_OFICINA VARCHAR, 
	ESPECIALIZACAO VARCHAR,
	CNH VARCHAR,
	PESSOA_TIPO INTEGER,
	PRIMARY KEY(ID_PESSOA)
);
	
CREATE TABLE CONTRATA(
	ID_CONTRATA SERIAL,
	FK_PESSOA_ID_PESSOA INTEGER NOT NULL REFERENCES PESSOA(ID_PESSOA),
	FK_PESSOA_ID_MECANICO INTEGER NOT NULL REFERENCES PESSOA(ID_PESSOA),
	HORA_CONTRATA TIME NOT NULL,
	DATA_CONTRATA DATE NOT NULL
);

CREATE TABLE TIPO_CONTATO(
	ID_TIPO_CONTATO SERIAL,
	TIPO_CONTATO VARCHAR NOT NULL,
	PRIMARY KEY(ID_TIPO_CONTATO)
);

CREATE TABLE CONTATO(
	ID_CONTATO SERIAL,
	CONTATO VARCHAR NOT NULL,
	FK_PESSOA_ID_PESSOA INTEGER NOT NULL REFERENCES PESSOA(ID_PESSOA),
	FK_TIPO_CONTATO_ID_TIPO_CONTATO INTEGER NOT NULL REFERENCES TIPO_CONTATO(ID_TIPO_CONTATO),
	PRIMARY KEY(ID_CONTATO)
);

CREATE TABLE MARCA(
	ID_MARCA SERIAL,
	MARCA VARCHAR NOT NULL,
	PRIMARY KEY(ID_MARCA)
);

CREATE TABLE MODELO(
	ID_MODELO SERIAL,
	MODELO_VEICULO VARCHAR NOT NULL,
	ANO_VEICULO INTEGER NOT NULL,
	COR VARCHAR NOT NULL,
	FK_MARCA_ID_MARCA INTEGER NOT NULL,
	PRIMARY KEY(ID_MODELO)
);

CREATE TABLE CATEGORIA(
	ID_CATEGORIA SERIAL,
	CATEGORIA VARCHAR NOT NULL,
	PRIMARY KEY(ID_CATEGORIA)
	
);

CREATE TABLE VEICULO(
	PLACA VARCHAR NOT NULL,
	ID_VEICULO SERIAL,
	FK_PESSOA_ID_PESSOA INTEGER REFERENCES PESSOA(ID_PESSOA),
	FK_MODELO_ID_MODELO INTEGER REFERENCES MODELO(ID_MODELO),
	FK_CATEGORIA_ID_CATEGORIA INTEGER REFERENCES CATEGORIA(ID_CATEGORIA),	
	PRIMARY KEY(ID_VEICULO)
);

CREATE TABLE TIPO_SENSOR(
	ID_TIPO_SENSOR SERIAL,
	TIPO_SENSOR VARCHAR,
	PRIMARY KEY(ID_TIPO_SENSOR)
);

CREATE TABLE SENSORES(
	ID_SENSOR SERIAL,
	NOME_SENSOR VARCHAR,
	DESCRICAO VARCHAR,
	FK_VEICULO_ID_VEICULO INTEGER REFERENCES VEICULO(ID_VEICULO),
	FK_TIPO_SENSOR_ID_TIPO_SENSOR INTEGER REFERENCES TIPO_SENSOR(ID_TIPO_SENSOR),
	PRIMARY KEY (ID_SENSOR)
);

CREATE TABLE HISTORICO(
	DATA_ANALISE DATE NOT NULL,
	HORA_ANALISE TIME NOT NULL,
	ID_HISTORICO SERIAL,
	PRIMARY KEY(ID_HISTORICO)
);

CREATE TABLE GERAM(
	FK_SENSORES_ID_SENSOR INTEGER REFERENCES SENSORES(ID_SENSOR),
	FK_HISTORICO_ID_HISTORICO INTEGER REFERENCES HISTORICO(ID_HISTORICO),
	ESTADO_PECA INTEGER NOT NULL
)
